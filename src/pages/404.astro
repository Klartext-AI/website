---
import BaseLayout from '../layouts/BaseLayout.astro';
import Footer from '../components/Footer.astro';

const BASE = import.meta.env.BASE_URL;

// Detect language from URL path (works for /en/... and everything else -> de)
const pathname = Astro.url.pathname.replace(BASE, '/');
const lang = pathname.startsWith('/en') ? 'en' : 'de';

const copy = {
  de: {
    title: '404 ‚Äì Seite nicht gefunden | Klartext AI',
    description:
      'Diese Seite existiert nicht (mehr). Bruno hat √ºberall gesucht ‚Äì aber wir bringen dich zur√ºck auf Kurs.',
    kicker: 'Wuff. 404.',
    headline: 'Bruno hat √ºberall gesucht. Mit Lupe.',
    body: 'Diese Seite gibt‚Äôs leider nicht (mehr) ‚Äì aber wir bringen dich schnell zur√ºck auf Kurs.',
    biscuit: 'Keks werfen üç™ (neu laden)',
    biscuitMsg: 'Bruno ist motiviert. Er sucht weiter‚Ä¶',
    primary: 'Zur Startseite',
    secondary: 'Unsere Angebote',
    tertiary: 'Erfolgsgeschichten',
    contact: 'Kontakt'
  },
  en: {
    title: "404 ‚Äì Page not found | Klartext AI",
    description:
      "This page doesn't exist (anymore). Bruno looked everywhere ‚Äî but we‚Äôll get you back on track.",
    kicker: 'Woof. 404.',
    headline: 'Bruno looked everywhere.',
    body: "This page doesn't exist (anymore) ‚Äî but we‚Äôll get you back on track.",
    biscuit: 'Throw a biscuit üç™ (reload)',
    biscuitMsg: 'Bruno is motivated. He keeps searching‚Ä¶',
    primary: 'Back to Home',
    secondary: 'Our Offerings',
    tertiary: 'Success Stories',
    contact: 'Contact'
  }
} as const;

const t = copy[lang];

// Route targets
const hrefHome = lang === 'en' ? `${BASE}en/` : `${BASE}`;
const hrefOfferings = lang === 'en' ? `${BASE}en/offerings` : `${BASE}offerings`;
const hrefStories = lang === 'en' ? `${BASE}en/success-stories` : `${BASE}success-stories`;
const hrefContact = lang === 'en' ? `${BASE}en/contact` : `${BASE}contact`;

// Bruno image (put your magnifying-glass PNG here)
const brunoImg = `${BASE}bruno/bruno-magnifier.png`; // <- rename/path adjust to your file
---

<BaseLayout title={t.title} description={t.description} lang={lang} alwaysShowNav={true}>
  <main class="bruno-404">
    <div class="container">
      <div class="hero">
        <p class="kicker">{t.kicker}</p>
        <h1 class="headline">{t.headline}</h1>

        <div class="bruno-wrap">
          <img class="bruno-img" src={brunoImg} alt="Bruno with a magnifying glass" loading="eager" />
        </div>

        <p class="body">{t.body}</p>

        <div class="actions">
          <a class="btn primary" href={hrefHome}>{t.primary}</a>
          <a class="btn" href={hrefOfferings}>{t.secondary}</a>
          <a class="btn" href={hrefStories}>{t.tertiary}</a>
          <a class="btn ghost" href={hrefContact}>{t.contact}</a>
        </div>

        <div class="biscuit-row">
          <button class="biscuit" id="biscuit-btn" type="button">{t.biscuit}</button>
          <span class="biscuit-msg" id="biscuit-msg" hidden>{t.biscuitMsg}</span>
        </div>
      </div>
    </div>
  </main>

  <Footer lang={lang} />

  <script>
    const btn = document.getElementById('biscuit-btn');
    const msg = document.getElementById('biscuit-msg');

    if (btn) {
      btn.addEventListener('click', () => {
        if (msg) {
          msg.hidden = false;
          msg.classList.remove('pop');
          void msg.offsetWidth; // restart animation
          msg.classList.add('pop');
        }
        // reload after a tiny delay so the joke message flashes
        setTimeout(() => {
          window.location.reload();
        }, 350);
      });
    }
  </script>
</BaseLayout>

<style>
  .bruno-404 {
    min-height: 78vh;
    display: flex;
    align-items: center;
    padding: var(--space-2xl) 0;
  }

  .hero {
    max-width: 980px;
    margin: 0 auto;
    text-align: center;
  }

  .kicker {
    color: var(--color-blue);
    font-weight: 800;
    letter-spacing: 0.08em;
    text-transform: uppercase;
    margin-bottom: var(--space-sm);
  }

  .headline {
    font-size: clamp(2.2rem, 4vw, 3.2rem);
    font-weight: 500;
    color: var(--color-text-dark);
    line-height: 1.1;
    margin-bottom: var(--space-md);
  }

  .bruno-wrap {
    display: grid;
    place-items: center;
    margin: var(--space-md) 0 var(--space-lg);
    /* move Bruno a bit up, closer to headline */
    margin-top: calc(var(--space-md) * -0.15);
  }

  .bruno-img {
    width: min(520px, 92vw);
    height: auto;
    filter: drop-shadow(0 18px 28px rgba(36, 121, 190, 0.18));
  }

  .body {
    color: var(--color-text-body);
    line-height: 1.7;
    font-size: 1.05rem;
    margin: 0 auto var(--space-lg);
    max-width: 70ch;
  }

  .actions {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: var(--space-sm);
    margin-bottom: var(--space-md);
  }

  .btn {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    padding: 0.75rem 1.05rem;
    border-radius: 12px;
    border: 1px solid rgba(36, 121, 190, 0.25);
    color: var(--color-blue);
    background: rgba(255, 255, 255, 0.65);
    font-weight: 700;
    transition: transform 0.2s ease, background 0.2s ease, box-shadow 0.2s ease;
  }

  .btn:hover {
    transform: translateY(-2px);
    background: rgba(255, 255, 255, 0.85);
    box-shadow: 0 14px 32px -18px rgba(36, 121, 190, 0.45);
  }

  .btn.primary {
    color: white;
    background: var(--color-blue);
    border-color: var(--color-blue);
  }

  .btn.primary:hover {
    background: var(--color-blue);
  }

  .btn.ghost {
    border-style: dashed;
    background: transparent;
  }

  .biscuit-row {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: var(--space-sm);
    margin-top: var(--space-sm);
  }

  .biscuit {
    border: 0;
    background: rgba(255, 255, 255, 0.8);
    border: 1px solid rgba(36, 121, 190, 0.25);
    color: var(--color-text-dark);
    font-weight: 800;
    border-radius: 999px;
    padding: 0.65rem 1rem;
    cursor: pointer;
    transition: transform 0.15s ease, background 0.2s ease;
  }

  .biscuit:hover {
    transform: translateY(-1px);
    background: rgba(255, 255, 255, 0.95);
  }

  .biscuit-msg {
    color: var(--color-text-muted);
    font-size: 0.95rem;
  }

  .biscuit-msg.pop {
    animation: pop 0.35s ease;
  }

  @keyframes pop {
    from { transform: translateY(6px); opacity: 0; }
    to { transform: translateY(0); opacity: 1; }
  }

  @media (max-width: 600px) {
    .headline {
      font-size: clamp(2rem, 7vw, 2.6rem);
    }

    .biscuit-row {
      flex-direction: column;
    }
  }
</style>