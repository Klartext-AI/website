---
interface Props {
  lang?: 'de' | 'en';
}

type LegalBlock =
  | { type: 'paragraph'; text: string }
  | { type: 'list'; ordered?: boolean; items: string[] };

type LegalSection = {
  heading: string;
  blocks: LegalBlock[];
};

type LegalContent = {
  title: string;
  lastUpdated: string;
  sections: LegalSection[];
};

const sectionsDe: LegalSection[] = [
  {
    heading: '1. Geltungsbereich',
    blocks: [
      {
        type: 'paragraph',
        text: 'Diese Allgemeinen Geschäftsbedingungen (AGB) gelten für alle Geschäftsbeziehungen zwischen der Klartext AI FlexCo (im Folgenden "Klartext AI" oder "wir") und ihren Kunden (im Folgenden "Kunde" oder "du"). Abweichende, entgegenstehende oder ergänzende Bedingungen werden nur dann Vertragsbestandteil, wenn Klartext AI diese ausdrücklich schriftlich anerkennt.',
      },
    ],
  },
  {
    heading: '2. Vertragsschluss',
    blocks: [
      {
        type: 'paragraph',
        text: 'Der Vertrag zwischen Klartext AI und dem Kunden kommt zustande, wenn Klartext AI ein Angebot des Kunden annimmt oder die Dienstleistung gemäß den vereinbarten Bedingungen bereitstellt.',
      },
    ],
  },
  {
    heading: '3. Leistungsumfang',
    blocks: [
      {
        type: 'paragraph',
        text: 'Klartext AI bietet Dienstleistungen im Bereich der Entwicklung und Implementierung maßgeschneiderter KI-Lösungen an. Dazu gehören insbesondere:',
      },
      {
        type: 'list',
        items: [
          '<em>Workflow- und Dokumentenautomatisierung</em> (z. B. Extraktion, Klassifikation, Generierung, Qualitäts- und Plausibilitätsprüfungen)',
          '<em>Wissensmanagement und KI-Assistenzsysteme</em> (z. B. RAG-Architekturen, semantische Suche, interne KI-Berater)',
          'Entwicklung von <em>Enterprise-AI-Architekturen</em>, einschließlich sicherer, auditierbarer und EU-AI-Act-konformer KI-Systeme',
          '<em>Prozessanalyse, Workshops und Beratungsleistungen</em> (z. B. AI Value Sprint, EU AI Act Workshop)',
          'Entwicklung von <em>SaaS- und On-Premise-Tools</em> zur automatisierten Prüfung von Dokumenten auf geltende Regularien sowie zur Ausweisung von Erfüllungsgraden, Verantwortlichkeiten und Handlungsempfehlungen',
        ],
      },
      {
        type: 'paragraph',
        text: 'Der konkrete Leistungsumfang ergibt sich aus dem jeweiligen Angebot, Vertrag oder Projektumfang, der individuell mit dem Kunden vereinbart wird.',
      },
    ],
  },
  {
    heading: '4. Preise und Zahlung',
    blocks: [
      {
        type: 'paragraph',
        text: 'Die Preise für unsere Dienstleistungen sind abhängig von der jeweiligen Vereinbarung oder dem Angebot. Alle Preise verstehen sich zuzüglich der gesetzlichen Mehrwertsteuer. Zahlungen sind gemäß den vereinbarten Zahlungsbedingungen fällig.',
      },
    ],
  },
  {
    heading: '5. Haftung',
    blocks: [
      {
        type: 'paragraph',
        text: 'Klartext AI haftet nur für Schäden, die auf vorsätzlichem oder grob fahrlässigem Verhalten beruhen. Eine Haftung für leichte Fahrlässigkeit ist ausgeschlossen, soweit keine wesentlichen Vertragspflichten betroffen sind. Für die Richtigkeit und Vollständigkeit der gelieferten Analysen und Ergebnisse übernehmen wir keine Haftung, es sei denn, es wurde ausdrücklich etwas anderes vereinbart.',
      },
    ],
  },
  {
    heading: '6. Verweise und Links',
    blocks: [
      {
        type: 'paragraph',
        text: 'Unsere Website kann Links zu externen Webseiten enthalten, die wir sorgfältig ausgewählt haben. Klartext AI übernimmt jedoch keine Haftung für den Inhalt dieser externen Seiten und identifiziert sich nicht mit deren Inhalten. Wenn du auf einer verlinkten Webseite rechtswidrige Inhalte erkennst, bitten wir um Mitteilung, und wir werden den Link nach Prüfung entfernen. Wir freuen uns über Backlinks, behalten uns jedoch das Recht vor, schadhafte Links zu überprüfen und gegebenenfalls zu entfernen.',
      },
    ],
  },
  {
    heading: '7. Copyright',
    blocks: [
      {
        type: 'paragraph',
        text: 'Klartext AI behält sich sämtliche Rechte, insbesondere Urheberrechte, am gesamten Inhalt und Design dieser Website vor. Ausgenommen hiervon sind Inhalte, die durch Dritte zur Verfügung gestellt wurden, sowie rechtliche Texte und Inhalte, die lizenzfrei verwendet werden.',
      },
    ],
  },
  {
    heading: '8. Beschwerden, Ombudsstelle, Streitschlichtung',
    blocks: [
      {
        type: 'paragraph',
        text: 'Wir sind bereit, an einem außergerichtlichen Schlichtungsverfahren teilzunehmen. Die Kontaktdaten der Internet-Ombudsstelle lauten:',
      },
      { type: 'paragraph', text: 'Internet Ombudsstelle' },
      {
        type: 'paragraph',
        text: 'c/o Österreichisches Institut für angewandte Medienkommunikation (ÖIAT)',
      },
      { type: 'paragraph', text: 'Ungargasse 64-66/3/404' },
      { type: 'paragraph', text: '1030 Wien' },
      {
        type: 'paragraph',
        text: 'Alternative Streitbeilegung gemäß Art. 14 Abs. 1 ODR-VO: Die Europäische Kommission stellt eine Plattform zur Online-Streitbeilegung (OS) bereit, die du unter ec.europa.eu/consumers/odr findest. Zur Teilnahme an einem Streitbeilegungsverfahren vor einer Verbraucherschlichtungsstelle sind wir nicht verpflichtet und nicht bereit.',
      },
    ],
  },
  {
    heading: '9. Gerichtsstand und anwendbares Recht',
    blocks: [
      {
        type: 'paragraph',
        text: 'Für B2B-Verträge gilt das sachlich und örtlich zuständige Gericht für den Sitz von Klartext AI als Gerichtsstand. Für B2C-Verträge mit einem/einer Verbraucher:in aus einem Mitgliedsstaat der EU hat dieser/diese die Wahl zwischen seinem/ihrem Wohnsitzgerichtsstand und dem von Klartext AI.',
      },
      {
        type: 'paragraph',
        text: 'Es gilt, sofern dem keine gesetzlich zwingenden Bestimmungen entgegenstehen, das österreichische Recht. Die Anwendung des UN-Kaufrechts (UNK) wird ausdrücklich ausgeschlossen. Zwingende Verbraucherschutzbestimmungen nach dem Recht des Staates, in dem der Verbraucher den gewöhnlichen Aufenthalt hat, bleiben hiervon unberührt.',
      },
    ],
  },
  {
    heading: '10. Datenschutz und Verwendung von Cookies',
    blocks: [
      {
        type: 'paragraph',
        text: 'Die Verarbeitung personenbezogener Daten erfolgt gemäß unserer Datenschutzerklärung. Darüber hinaus verwenden wir auf unserer Website Cookies, um die Nutzererfahrung zu verbessern und den Anforderungen der DSGVO zu entsprechen. Weitere Informationen über die Verwendung von Cookies findest du in unserer Cookie-Richtlinie.',
      },
    ],
  },
];

// The English copy currently mirrors the German base text.
const sectionsEn: LegalSection[] = JSON.parse(JSON.stringify(sectionsDe));

const content: Record<'de' | 'en', LegalContent> = {
  de: {
    title: 'Allgemeine Geschäftsbedingungen (AGBs)',
    lastUpdated: 'Zuletzt aktualisiert am: 20.01.2025',
    sections: sectionsDe,
  },
  en: {
    title: 'Terms and Conditions',
    lastUpdated: 'Last Updated: 20.01.2025',
    sections: sectionsEn,
  },
};

const { lang = 'de' } = Astro.props;
const text = content[lang];
---

<section id="agb" class="legal-page section">
  <div class="container">
    <div class="legal-content fade-in">
      <h1 class="legal-title">{text.title}</h1>
      <p class="legal-updated">{text.lastUpdated}</p>

      {text.sections.map((section) => (
        <div class="legal-section">
          <h2 class="legal-heading">{section.heading}</h2>
          <div class="legal-text">
            {section.blocks.map((block) => {
              if (block.type === 'paragraph') {
                return <p>{block.text}</p>;
              }

              if (block.type === 'list') {
                return block.ordered ? (
                  <ol>
                    {block.items.map((item) => (
                      <li set:html={item} />
                    ))}
                  </ol>
                ) : (
                  <ul>
                    {block.items.map((item) => (
                      <li set:html={item} />
                    ))}
                  </ul>
                );
              }

              return null;
            })}
          </div>
        </div>
      ))}
    </div>
  </div>
</section>

<style>
  .legal-page {
    min-height: 80vh;
    padding: var(--space-2xl) 0;
    background: transparent;
  }

  .legal-content {
    max-width: 900px;
    margin: 0 auto;
  }

  .legal-title {
    font-size: var(--font-size-h1);
    font-weight: 300;
    margin-bottom: var(--space-sm);
    color: var(--color-text-dark);
    letter-spacing: -0.02em;
  }

  .legal-updated {
    font-size: 0.95rem;
    color: var(--color-text-muted);
    font-style: italic;
    margin-bottom: var(--space-2xl);
    padding-bottom: var(--space-lg);
    border-bottom: 1px solid rgba(36, 121, 190, 0.1);
  }

  .legal-section {
    margin-bottom: var(--space-xl);
  }

  .legal-heading {
    font-size: 1.5rem;
    font-weight: 500;
    color: var(--color-text-dark);
    margin-bottom: var(--space-md);
  }

  .legal-text {
    font-size: 1rem;
    line-height: 1.8;
    color: var(--color-text-body);
  }

  .legal-text p {
    margin-bottom: var(--space-md);
  }

  .legal-text ul,
  .legal-text ol {
    padding-left: 1.5rem;
    margin: var(--space-sm) 0 var(--space-md);
    list-style-position: outside;
  }

  .legal-text ul {
    list-style-type: disc;
  }

  .legal-text ol {
    list-style-type: decimal;
  }

  .legal-text li {
    margin-bottom: 0.5rem;
    line-height: 1.8;
  }

  @media (max-width: 768px) {
    .legal-page {
      padding: var(--space-xl) 0;
    }

    .legal-title {
      font-size: var(--font-size-h2);
    }

    .legal-heading {
      font-size: 1.25rem;
    }

    .legal-text {
      font-size: 0.95rem;
    }
  }
</style>
