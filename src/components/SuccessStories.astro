---
interface Props {
  lang?: 'de' | 'en';
}

const { lang = 'de' } = Astro.props as Props;
const BASE = import.meta.env.BASE_URL;

// Map story IDs to page URLs
const storyUrls: Record<string, string> = {
  'data-extraction-rfu': 'data-extraction-banking',
  'document-generation': 'grant-application-generation',
  'compliance-assistant': 'compliance-assistant'
};

const content = {
  de: {
    sectionTitle: "Erfolgsgeschichten",
    subtitle: "Messbarer Impact bei unseren Kunden",
    readMore: "Ganze Story lesen",
    viewAllStories: "Alle Erfolgsgeschichten ansehen",
    ctaCard: {
      title: "Wo kann KI in Ihrem Unternehmen echten Wert stiften?",
      description: "Finden Sie es heraus im AI Value Sprint Workshop!",
      buttonText: "Angebote entdecken"
    },
    stories: [
      {
        id: "data-extraction-rfu",
        title: "KPI Datenextraktion",
        industry: "Banking Services",
        metric: "80% Zeitersparnis",
        breakeven: "Break-even: 1,5 Monate",
        description: "Automatisierte Extraktion von KPIs aus Finanzdokumenten mit domänenspezifischer KI."
      },
      {
        id: "document-generation",
        title: "Förderantrags-generierung",
        industry: "Funding Applications",
        metric: "95% Zeitersparnis",
        breakeven: "Break-even: 1 Monat",
        description: "Vollautomatische Generierung von Förderanträgen mit kontextbewusster KI-Unterstützung."
      },
      {
        id: "compliance-assistant",
        title: "Compliance Assistant",
        industry: "Knowledge Management",
        metric: "80% Zeitersparnis",
        breakeven: "Break-even: 2 Monate",
        description: "Intelligente Wissenssuche mit verifizierten Antworten und vollständiger Quellenangabe."
      }
    ]
  },
  en: {
    sectionTitle: "Success Stories",
    subtitle: "Measurable impact for our clients",
    readMore: "Read full story",
    viewAllStories: "View all success stories",
    ctaCard: {
      title: "Where can AI create real value in your company?",
      description: "Find out in our AI Value Sprint Workshop!",
      buttonText: "Discover our offers"
    },
    stories: [
      {
        id: "data-extraction-rfu",
        title: "KPI Data Extraction",
        industry: "Banking Services",
        metric: "80% time savings",
        breakeven: "Break-even: 1.5 months",
        description: "Automated extraction and processing of financial documents using domain-specific AI."
      },
      {
        id: "document-generation",
        title: "Automatic Funding Application Generation",
        industry: "Funding Applications",
        metric: "95% time savings",
        breakeven: "Break-even: 1 month",
        description: "Fully automated generation of funding applications with context-aware AI support."
      },
      {
        id: "compliance-assistant",
        title: "Compliance Assistant",
        industry: "Knowledge Management",
        metric: "80% time savings",
        breakeven: "Break-even: 2 months",
        description: "Intelligent knowledge search with verified answers and complete source attribution."
      }
    ]
  }
} as const;

const text = content[lang];
---

<section class="success-stories section">
  <div class="container">
    <div class="section-header fade-in text-center">
      <h2>{text.sectionTitle}</h2>
      <p class="section-subtitle">{text.subtitle}</p>
    </div>

    <div class="stories-grid-container">
      <div class="stories-wrapper">
        {text.stories.map((story, index) => (
          <a
            href={
              lang === "en"
                ? `${BASE}en/success-stories/${storyUrls[story.id]}`
                : `${BASE}success-stories/${storyUrls[story.id]}`
            }
            class="story-card-link"
          >
            <article class="story-card glass-card" style={`animation-delay: ${index * 0.15}s`}>
              <h3 class="story-title">{story.title}</h3>

              <div class="story-metrics">
                <div class="metric-badge metric-primary">{story.metric}</div>
                <div class="metric-badge metric-secondary">{story.breakeven}</div>
              </div>

              <p class="story-description">{story.description}</p>

              <div class="story-link">
                {text.readMore}
                <svg width="16" height="16" viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M6 12l4-4-4-4" />
                </svg>
              </div>
            </article>
          </a>
        ))}

        <a
          href={lang === "de" ? `${BASE}offerings` : `${BASE}en/offerings`}
          class="story-card-link cta-card-link"
        >
          <article class="story-card cta-card" style="animation-delay: 0.6s">
            <h3 class="cta-title">{text.ctaCard.title}</h3>

            <p class="cta-description">{text.ctaCard.description}</p>

            <div class="cta-button">
              {text.ctaCard.buttonText}
            </div>
          </article>
        </a>
      </div>
    </div>

    <div class="stories-cta text-center fade-in">
      <a href={lang === "de" ? `${BASE}success-stories` : `${BASE}en/success-stories`} class="btn btn-secondary">
        {text.viewAllStories}
      </a>
    </div>
  </div>
</section>

<style>
  .success-stories {
    position: relative;
    overflow: hidden;
  }

  .success-stories .section-subtitle {
    margin-left: auto;
    margin-right: auto;
    text-align: center;
  }

  .stories-grid-container {
    padding-top: var(--space-md);
  }

  .stories-wrapper {
    display: grid;
    grid-template-columns: repeat(4, minmax(0, 1fr));
    gap: var(--space-md);
  }

  .story-card-link {
    text-decoration: none;
    color: inherit;
    display: block;
  }

  .story-card {
    display: flex;
    flex-direction: column;
    text-align: center;
    align-items: center;
    height: 100%;
    transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    cursor: pointer;
  }

  .story-card-link:hover .story-card {
    transform: translateY(-8px) scale(1.02);
    box-shadow: 0 16px 48px -12px rgba(36, 121, 190, 0.35);
  }

  .story-title {
    font-size: 1.75rem;
    font-weight: 500;
    margin-bottom: var(--space-md);
    color: var(--color-text-dark);
  }

  .story-metrics {
    display: flex;
    flex-wrap: wrap;
    gap: var(--space-xs);
    margin-bottom: var(--space-md);
    justify-content: center;
  }

  .metric-badge {
    padding: 0.5rem 1rem;
    border-radius: 2rem;
    font-size: 0.9rem;
    font-weight: 600;
  }

  .metric-primary {
    background: var(--color-blue);
    color: white;
  }

  .metric-secondary {
    background: rgba(76, 138, 197, 0.2);
    color: var(--color-blue);
  }

  .story-description {
    flex-grow: 1;
    color: var(--color-text-body);
    line-height: 1.6;
    margin-bottom: var(--space-md);
    text-align: center;
  }

  .story-link {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    color: var(--color-blue);
    font-weight: 600;
    margin-top: auto;
    transition: gap 0.3s ease;
    justify-content: center;
    width: 100%;
  }

  .story-card-link:hover .story-link {
    gap: 0.75rem;
  }

  .story-link svg {
    transition: transform 0.3s ease;
  }

  .story-card-link:hover .story-link svg {
    transform: translateX(4px);
  }

  .stories-cta {
    margin-top: var(--section-cta-gap);
  }

  /* CTA Card Styles */
  .cta-card {
    background: linear-gradient(
      135deg,
      rgba(36, 121, 190, 0.95) 0%,
      rgba(76, 138, 197, 0.9) 100%
    );
    border: 1px solid rgba(255, 255, 255, 0.3);
    border-radius: 1rem;
    color: white;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    text-align: center;
    padding: var(--space-md);
  }

  .cta-card-link:hover .cta-card {
    transform: translateY(-8px) scale(1.02);
    box-shadow: 0 20px 60px -12px rgba(36, 121, 190, 0.5);
  }

  .cta-title {
    font-size: 1.875rem;
    font-weight: 600;
    line-height: 1.3;
    margin-bottom: var(--space-md);
    color: white;
  }

  .cta-description {
    font-size: 1.125rem;
    line-height: 1.6;
    margin-bottom: var(--space-xl);
    color: rgba(255, 255, 255, 0.95);
    max-width: 90%;
  }

  .cta-button {
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    padding: 1rem 2rem;
    background: white;
    color: var(--color-blue);
    font-weight: 600;
    font-size: 1.125rem;
    border-radius: 12px;
    transition: all 0.3s ease;
    margin-top: auto;
  }

  .cta-card-link:hover .cta-button {
    gap: 0.75rem;
    background: rgba(36, 121, 190, 0.95);
    color: white;
    transform: translateY(-2px);
    box-shadow: 0 12px 32px -8px rgba(36, 121, 190, 0.35);
  }

  @media (max-width: 1024px) {
    .stories-wrapper {
      grid-template-columns: repeat(2, minmax(0, 1fr));
    }
  }

  @media (max-width: 640px) {
    .stories-wrapper {
      grid-template-columns: 1fr;
    }
  }
</style>
